# UBID Data Flow

This document gives a high-level overview of the flow of information in a software system that utilizes the Unique Building Identifier (UBID) concept.

![Depiction of UBID data flow diagram.](https://raw.githubusercontent.com/pnnl/buildingid-super/master/images/UBID_data_flow_diagram.png)

The data flow diagram above is a directed graph, where labeled nodes and edges correspond to data types and data transformations, respectively.

## 1. Street Address

When the input data is a street address, the workflow is to geolocate the street address to a pair of latitude and longitude coordinates.

For example, the following street address

```
24 Willie Mays Plaza
San Francisco, CA 94107
```

is geolocated to the following pair of latitude and longitude coordinates

```
37.7784744216144 N, 122.3896056846471 W
```

Click [here](https://buildingid.github.io/examples/encode-example.html?centroid-latitude=37.7784744216144&centroid-longitude=-122.3896056846471&code-length=11) to view this example.

## 2. Latitude and Longitude Coordinates

When the input data is a pair of latitude and longitude coordinates, the workflow is to assume that said coordinates are for both the centroid of the geometry and the minima and maxima of the minimum bounding rectangle for the geometry.

Using the pair of latitude and longitude coordinates from the previous section as an example, the invocation of the `encode` operation is

```
encode(37.7784744216144, -122.3896056846471, 37.7784744216144, -122.3896056846471, 37.7784744216144, -122.3896056846471, 11)
```

where `11` is the Open Location Code (OLC) resolution.

The result of the invocation to the `encode` operation is

```
849VQJH6+95J-0-0-0-0
```

Click [here](https://buildingid.github.io/examples/encode-example.html?centroid-latitude=37.7784744216144&centroid-longitude=-122.3896056846471&code-length=11) to view this example.

## 3. Centroid and Minimum Bounding Rectangle

When the input data is three pairs of latitude and longitude coordinates (the centroid and the minima and maxima of the minimum bounding rectangle), the workflow is to invoke the `encode` operation.

For example, using the following data

| Centroid | Minima | Maxima |
|-|-|-|
| `37.7784744216144 N, 122.3896056846471 W` | `37.777404202489 N, 122.391163268176 W` | `37.779726076137 N, 122.387805614265 W` |

the invocation of the `encode` operation is

```
encode(37.777404202489, -122.391163268176, 37.779726076137, -122.387805614265, 37.7784744216144, -122.3896056846471, 11)
```

where `11` is the Open Location Code (OLC) resolution.

The result of the invocation to the `encode` operation is

```
849VQJH6+95J-51-58-42-50
```

Click [here](https://buildingid.github.io/examples/encode-example.html?bbox-latitude-lo=37.777404202489&bbox-longitude-lo=-122.391163268176&bbox-latitude-hi=37.779726076137&bbox-longitude-hi=-122.387805614265&centroid-latitude=37.7784744216144&centroid-longitude=-122.3896056846471&code-length=11) to view this example.

## 4. Geometry

When the input data is a geometry for a two-dimensional shape, the workflow is to calculate the centroid of the geometry and the minima and maxima of the minimum bounding rectangle for the geometry.

For example, the following geometry, represented using the [Well Known Text](https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry) markup language

```
MULTIPOLYGON (((-122.38881976231 37.77923523529, -122.388804119691 37.779248288341, -122.388804089115 37.779249576693, -122.388736336901 37.779305686423, -122.388735345943 37.779305673294, -122.388703640352 37.779332128723, -122.387810661362 37.778614548526, -122.387814609477 37.778585892065, -122.387811140111 37.778585064958, -122.387805638074 37.778578430108, -122.387805614265 37.778578395859, -122.387816682916 37.77854710155, -122.387824621151 37.778543969508, -122.387829917765 37.778545142646, -122.387843084163 37.778523260839, -122.387896335497 37.778468172867, -122.387962000419 37.77843477294, -122.388048278897 37.778413723325, -122.388043887139 37.778360677165, -122.387972853509 37.778366564486, -122.387972011798 37.778359120335, -122.387968898485 37.778331585446, -122.387967645497 37.778320504815, -122.387967634233 37.778320400298, -122.387963916965 37.778287525117, -122.387963895553 37.778287339509, -122.387960863375 37.778260520923, -122.387954289726 37.778202371488, -122.387949281041 37.778166385522, -122.389835233078 37.77745188375, -122.38986971218 37.777471016061, -122.390045769351 37.777404202489, -122.390062963308 37.77741191262, -122.390063248196 37.777416158076, -122.390111512516 37.777443103221, -122.39010759583 37.777448050188, -122.390152249683 37.777471863556, -122.390158544926 37.777464862711, -122.390168691674 37.777463362365, -122.390201430179 37.777481801759, -122.390201450581 37.777481838709, -122.390202683332 37.77748884698, -122.390196947837 37.777495673325, -122.390247420396 37.777522166354, -122.39023235128 37.777538456127, -122.390224289065 37.77754780037, -122.39035498364 37.777624142545, -122.390567391687 37.777748214387, -122.390566999735 37.77774863854, -122.390567525042 37.777748947834, -122.390591503993 37.7777222051, -122.390775600375 37.777511131413, -122.391163247776 37.777816527598, -122.391163268176 37.777816568151, -122.390973596727 37.778020188724, -122.391006786462 37.778038443423, -122.391006820466 37.778038506507, -122.390993361707 37.778053904334, -122.390976857436 37.778045038757, -122.390835686813 37.778206376238, -122.390850458566 37.778214261624, -122.390850493704 37.778214324709, -122.390837583723 37.77823041653, -122.390813486805 37.77821709639, -122.390780069996 37.778257200123, -122.390785063234 37.77830858422, -122.390823399516 37.778336990838, -122.39085264379 37.778313813984, -122.390867077617 37.778314179809, -122.390956144591 37.77838670738, -122.390956191064 37.778386792093, -122.390956100561 37.778396396251, -122.390879915489 37.77845704472, -122.390881401454 37.77845834825, -122.390881435458 37.778458410433, -122.390487907156 37.778770264228, -122.389936204412 37.779207393523, -122.389933974451 37.779205292256, -122.389447210953 37.77959773692, -122.389404939621 37.779565835728, -122.389356546938 37.779604319533, -122.389385249504 37.779627102385, -122.38938530279 37.779627181697, -122.389385283306 37.779637140865, -122.389293394157 37.779709285436, -122.389280047221 37.779709292973, -122.389252372555 37.779687162918, -122.389203439037 37.779726076137, -122.389151650465 37.779682070992, -122.388793058965 37.779398370319, -122.388793015881 37.779398309032, -122.388792658821 37.779394941069, -122.38877692709 37.779382491581, -122.388776873802 37.779382415873, -122.388783272226 37.779377285544, -122.388759566159 37.779358014369, -122.388869280695 37.779274401268, -122.38881976231 37.77923523529), (-122.389625551223 37.778787753654, -122.390022584172 37.778474208924, -122.390046898675 37.7784935198, -122.390059946264 37.778481594162, -122.390088152711 37.778453568019, -122.390103437588 37.778424777596, -122.390111347401 37.778394833801, -122.390116110847 37.778363260377, -122.390114143257 37.778330031176, -122.390101669875 37.778301407733, -122.39008430577 37.77827219618, -122.390061702629 37.778247821001, -122.390031474075 37.778223121195, -122.389989871514 37.778201471636, -122.38994266161 37.778176904607, -122.389925657026 37.778195876403, -122.389420752733 37.777912640753, -122.389420055657 37.777912787251, -122.389250616934 37.777901612833, -122.389172610862 37.777849327882, -122.389141368803 37.777790396354, -122.389111008608 37.777802237266, -122.388743193 37.777931686253, -122.388722412831 37.777990487231, -122.388469735593 37.778085792145, -122.38846982455 37.778086657111, -122.388472019367 37.778085876226, -122.388497455754 37.778343820929, -122.388498808883 37.778343734243, -122.388521469209 37.778565731995, -122.388520293163 37.778565807963, -122.388530573085 37.778646332764, -122.388532309016 37.778645930041, -122.389048331131 37.779055009184, -122.38888666188 37.779184683975, -122.388944286357 37.779233343004, -122.389125460634 37.779074434049, -122.389125443332 37.779074769197, -122.389125470593 37.779074746687, -122.389164929554 37.779086193004, -122.389274409874 37.778979794197, -122.389366956551 37.778929832434, -122.389625551223 37.778787753654), (-122.388372451429 37.778574605156, -122.388355623774 37.77841410796, -122.388347867669 37.778355167791, -122.388250520718 37.77836134423, -122.388254674487 37.778407281707, -122.388234227605 37.778408689096, -122.388248431304 37.77854105345, -122.388264910509 37.778540216988, -122.388269666512 37.778581336459, -122.388328283828 37.778577498445, -122.388372451429 37.778574605156), (-122.388423918722 37.778350342391, -122.388445393576 37.778569826769, -122.388459002116 37.778568935623, -122.388518549129 37.77856503223, -122.388496168064 37.778345758216, -122.388423918722 37.778350342391)))
```

has the following data

| Centroid | Minima | Maxima |
|-|-|-|
| `37.7785125 N, 122.3896056846471 W` | `37.777399999999965 N, 122.39118750000102 W` | `37.77975000000004 N, 122.38778124999878 W` |

Click [here](https://buildingid.github.io/examples/well-known-text-read-example.html?wkt=MULTIPOLYGON%20%28%28%28-122.38881976231%2037.77923523529%2C%20-122.388804119691%2037.779248288341%2C%20-122.388804089115%2037.779249576693%2C%20-122.388736336901%2037.779305686423%2C%20-122.388735345943%2037.779305673294%2C%20-122.388703640352%2037.779332128723%2C%20-122.387810661362%2037.778614548526%2C%20-122.387814609477%2037.778585892065%2C%20-122.387811140111%2037.778585064958%2C%20-122.387805638074%2037.778578430108%2C%20-122.387805614265%2037.778578395859%2C%20-122.387816682916%2037.77854710155%2C%20-122.387824621151%2037.778543969508%2C%20-122.387829917765%2037.778545142646%2C%20-122.387843084163%2037.778523260839%2C%20-122.387896335497%2037.778468172867%2C%20-122.387962000419%2037.77843477294%2C%20-122.388048278897%2037.778413723325%2C%20-122.388043887139%2037.778360677165%2C%20-122.387972853509%2037.778366564486%2C%20-122.387972011798%2037.778359120335%2C%20-122.387968898485%2037.778331585446%2C%20-122.387967645497%2037.778320504815%2C%20-122.387967634233%2037.778320400298%2C%20-122.387963916965%2037.778287525117%2C%20-122.387963895553%2037.778287339509%2C%20-122.387960863375%2037.778260520923%2C%20-122.387954289726%2037.778202371488%2C%20-122.387949281041%2037.778166385522%2C%20-122.389835233078%2037.77745188375%2C%20-122.38986971218%2037.777471016061%2C%20-122.390045769351%2037.777404202489%2C%20-122.390062963308%2037.77741191262%2C%20-122.390063248196%2037.777416158076%2C%20-122.390111512516%2037.777443103221%2C%20-122.39010759583%2037.777448050188%2C%20-122.390152249683%2037.777471863556%2C%20-122.390158544926%2037.777464862711%2C%20-122.390168691674%2037.777463362365%2C%20-122.390201430179%2037.777481801759%2C%20-122.390201450581%2037.777481838709%2C%20-122.390202683332%2037.77748884698%2C%20-122.390196947837%2037.777495673325%2C%20-122.390247420396%2037.777522166354%2C%20-122.39023235128%2037.777538456127%2C%20-122.390224289065%2037.77754780037%2C%20-122.39035498364%2037.777624142545%2C%20-122.390567391687%2037.777748214387%2C%20-122.390566999735%2037.77774863854%2C%20-122.390567525042%2037.777748947834%2C%20-122.390591503993%2037.7777222051%2C%20-122.390775600375%2037.777511131413%2C%20-122.391163247776%2037.777816527598%2C%20-122.391163268176%2037.777816568151%2C%20-122.390973596727%2037.778020188724%2C%20-122.391006786462%2037.778038443423%2C%20-122.391006820466%2037.778038506507%2C%20-122.390993361707%2037.778053904334%2C%20-122.390976857436%2037.778045038757%2C%20-122.390835686813%2037.778206376238%2C%20-122.390850458566%2037.778214261624%2C%20-122.390850493704%2037.778214324709%2C%20-122.390837583723%2037.77823041653%2C%20-122.390813486805%2037.77821709639%2C%20-122.390780069996%2037.778257200123%2C%20-122.390785063234%2037.77830858422%2C%20-122.390823399516%2037.778336990838%2C%20-122.39085264379%2037.778313813984%2C%20-122.390867077617%2037.778314179809%2C%20-122.390956144591%2037.77838670738%2C%20-122.390956191064%2037.778386792093%2C%20-122.390956100561%2037.778396396251%2C%20-122.390879915489%2037.77845704472%2C%20-122.390881401454%2037.77845834825%2C%20-122.390881435458%2037.778458410433%2C%20-122.390487907156%2037.778770264228%2C%20-122.389936204412%2037.779207393523%2C%20-122.389933974451%2037.779205292256%2C%20-122.389447210953%2037.77959773692%2C%20-122.389404939621%2037.779565835728%2C%20-122.389356546938%2037.779604319533%2C%20-122.389385249504%2037.779627102385%2C%20-122.38938530279%2037.779627181697%2C%20-122.389385283306%2037.779637140865%2C%20-122.389293394157%2037.779709285436%2C%20-122.389280047221%2037.779709292973%2C%20-122.389252372555%2037.779687162918%2C%20-122.389203439037%2037.779726076137%2C%20-122.389151650465%2037.779682070992%2C%20-122.388793058965%2037.779398370319%2C%20-122.388793015881%2037.779398309032%2C%20-122.388792658821%2037.779394941069%2C%20-122.38877692709%2037.779382491581%2C%20-122.388776873802%2037.779382415873%2C%20-122.388783272226%2037.779377285544%2C%20-122.388759566159%2037.779358014369%2C%20-122.388869280695%2037.779274401268%2C%20-122.38881976231%2037.77923523529%29%2C%20%28-122.389625551223%2037.778787753654%2C%20-122.390022584172%2037.778474208924%2C%20-122.390046898675%2037.7784935198%2C%20-122.390059946264%2037.778481594162%2C%20-122.390088152711%2037.778453568019%2C%20-122.390103437588%2037.778424777596%2C%20-122.390111347401%2037.778394833801%2C%20-122.390116110847%2037.778363260377%2C%20-122.390114143257%2037.778330031176%2C%20-122.390101669875%2037.778301407733%2C%20-122.39008430577%2037.77827219618%2C%20-122.390061702629%2037.778247821001%2C%20-122.390031474075%2037.778223121195%2C%20-122.389989871514%2037.778201471636%2C%20-122.38994266161%2037.778176904607%2C%20-122.389925657026%2037.778195876403%2C%20-122.389420752733%2037.777912640753%2C%20-122.389420055657%2037.777912787251%2C%20-122.389250616934%2037.777901612833%2C%20-122.389172610862%2037.777849327882%2C%20-122.389141368803%2037.777790396354%2C%20-122.389111008608%2037.777802237266%2C%20-122.388743193%2037.777931686253%2C%20-122.388722412831%2037.777990487231%2C%20-122.388469735593%2037.778085792145%2C%20-122.38846982455%2037.778086657111%2C%20-122.388472019367%2037.778085876226%2C%20-122.388497455754%2037.778343820929%2C%20-122.388498808883%2037.778343734243%2C%20-122.388521469209%2037.778565731995%2C%20-122.388520293163%2037.778565807963%2C%20-122.388530573085%2037.778646332764%2C%20-122.388532309016%2037.778645930041%2C%20-122.389048331131%2037.779055009184%2C%20-122.38888666188%2037.779184683975%2C%20-122.388944286357%2037.779233343004%2C%20-122.389125460634%2037.779074434049%2C%20-122.389125443332%2037.779074769197%2C%20-122.389125470593%2037.779074746687%2C%20-122.389164929554%2037.779086193004%2C%20-122.389274409874%2037.778979794197%2C%20-122.389366956551%2037.778929832434%2C%20-122.389625551223%2037.778787753654%29%2C%20%28-122.388372451429%2037.778574605156%2C%20-122.388355623774%2037.77841410796%2C%20-122.388347867669%2037.778355167791%2C%20-122.388250520718%2037.77836134423%2C%20-122.388254674487%2037.778407281707%2C%20-122.388234227605%2037.778408689096%2C%20-122.388248431304%2037.77854105345%2C%20-122.388264910509%2037.778540216988%2C%20-122.388269666512%2037.778581336459%2C%20-122.388328283828%2037.778577498445%2C%20-122.388372451429%2037.778574605156%29%2C%20%28-122.388423918722%2037.778350342391%2C%20-122.388445393576%2037.778569826769%2C%20-122.388459002116%2037.778568935623%2C%20-122.388518549129%2037.77856503223%2C%20-122.388496168064%2037.778345758216%2C%20-122.388423918722%2037.778350342391%29%29%29&code-length=11) to view this example.

## 5. UBID Code String

When the input data is a UBID code string, the workflow is to invoke the `decode` operation, yielding a UBID code area.

Click [here](https://buildingid.github.io/examples/decode-example.html?code=849VQJH6%2B95J-51-58-42-50) to view this example.
